/***********************************************************************
Auto Generated Code

Generated by   : adam-Laptop\adam
Date Generated : 28/04/2009 12:24 PM
Copyright @2009 CodeGenerator
***********************************************************************/
using System;
using System.Data;
using System.Configuration;
using System.ServiceModel;
using System.Xml;
using System.ServiceModel.Channels;
//using System.Web.Services.Description;
using ImardaSecurityBusiness;
using System.Diagnostics;

namespace Imarda360Application.Security
{
	partial class ImardaProxyManager
	{
		#region ImardaSecurityService
		private static ChannelFactory<ImardaSecurityBusiness.IImardaSecurity> _ImardaSecurityService = new ChannelFactory<ImardaSecurityBusiness.IImardaSecurity>("SecurityTcpEndpoint");
		private static EventLog _EventLog = new System.Diagnostics.EventLog();
		public static ImardaSecurityBusiness.IImardaSecurity ImardaSecurityService
		{
			get
			{
				if (!System.Diagnostics.EventLog.SourceExists("Fern_Security"))
					System.Diagnostics.EventLog.CreateEventSource(
						 "Fern_Security", "Fern");

				_EventLog.Source = "Fern_Security";
				_EventLog.Log = "Fern";

				if (_ImardaSecurityService != null)
				{
					_EventLog.WriteEntry("Start create channel for security service");
					return _ImardaSecurityService.CreateChannel();
				}
				else
				{
					_EventLog.WriteEntry("security service has null reference");
					return null;
				}
			}
		}
		#endregion
	}
}


